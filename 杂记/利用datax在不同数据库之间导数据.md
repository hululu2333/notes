### 利用datax在不同数据库之间导数据

***

> dataX 是被广泛使用的离线数据同步工具/平台，实现了各种异构数据源之间高效的数据同步功能。



#### 预期目标

> datax每运行一个job只支持同步一张表，我们现在需要在datax的基础上进行改造。通过shell脚本和java，完成一个程序，使其能够一键完成库级别的数据同步，并且支持多种数据源和目的端
>
> 在此基础上还支持同时进行全量同步和增量同步，增量同步支持手动指定增量依赖的那个字段



#### 项目思路

> 执行程序时首先判断数据源类型，然后调用相应的java代码将数据源数据库中各表和字段的信息保存在conf目录下。保存之前将源数据库中的数据类型替换为在datax中对应的类型，以便后期接入别的目的端。
>
> **同时实现全量和增量：**我打算在源数据库配置附近加一个配置文件，由我们手动填需要进行增量同步的表，以及增量的依据字段（一般按照时间字段来进行增量）。



#### 遇见的问题

> 源数据库有的数据库名、表名和字段名和关键词冲突，所以做相关操作时得给他们加上反引号
>
> 在hive建表时出现
>
> ```
> org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:Add request failed : INSERT INTO `COLUMNS_V2` (`CD_ID`,`COMMENT`,`COLUMN_NAME`,`TYPE_NAME`,`INTEGER_IDX`) VALUES (?,?,?,?,?) )
> ```
>
> 原因是因为hive元数据库编码不支持储存中文，当有hive表的字段名为中文时，则建表失败。解决方式是将hive元数据库中的编码改为utf-8